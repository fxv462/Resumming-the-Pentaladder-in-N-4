(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45555,       1094]
NotebookOptionsPosition[     43316,       1050]
NotebookOutlinePosition[     43689,       1066]
CellTagsIndexPosition[     43646,       1063]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$HenriksPackagePath", "=", 
   "\"\<C:\\\\Users\\\\zalat\\\\OneDrive\\\\Dokumenter\\\\Fysik & Matematik\\\
\\Master's Thesis\>\""}], ";"}], "\n", 
 RowBox[{"Get", "[", 
  RowBox[{"ToFileName", "[", 
   RowBox[{
    RowBox[{"{", "$HenriksPackagePath", "}"}], ",", 
    "\"\<HenriksPackage_v3.wl\>\""}], "]"}], "]"}]}], "Code",
 CellChangeTimes->{{3.764341947099099*^9, 3.764341952710857*^9}, {
  3.764410651531646*^9, 3.7644106527031884`*^9}, {3.76492658476382*^9, 
  3.7649265849740477`*^9}, {3.764932047686003*^9, 3.764932048118619*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"a81b38c6-db3a-4a9f-a08f-cd828d9f6c3f"],

Cell[BoxData["\<\"Oups, the package is already loaded! You cannot reload \
it.\"\>"], "Print",
 CellFrame->0.5,
 CellChangeTimes->{{3.7650096407702827`*^9, 3.76500964239447*^9}},
 FontColor->GrayLevel[0.],
 Background->RGBColor[0.796887, 0.789075, 0.871107],
 ButtonBoxOptions->{Active->True},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"3547c7cb-b769-43a9-a210-5cdea7301305"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.76500964241008*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"24fe46e8-e279-4bbd-a525-a7ed7b55a2b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Functions",
 FontSize->18]], "Section",
 CellChangeTimes->{{3.7650129748827453`*^9, 
  3.7650129842496433`*^9}},ExpressionUUID->"ab6eaadb-ac90-4cc4-9736-\
f9aef3928c7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "delta", "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[CapitalDelta]temp", " ", "*", " ", 
     SubscriptBox["\[CapitalDelta]", "0"], " ", "is", " ", "in", " ", "the", 
     " ", "same", " ", "order", " ", "as", " ", 
     SubscriptBox["L", "1"]}], ",", " ", 
    SubscriptBox["L", "2"], ",", " ", 
    RowBox[{
     RowBox[{"...", " ", "and", " ", 
      SubscriptBox["\[CapitalDelta]", "0"]}], " ", "=", " ", 
     RowBox[{"shift", " ", "in", " ", "k"}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"delta", "[", 
   RowBox[{"func_", ",", "k_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "factors", ",", "mlist", ",", "A", ",", "Cr", ",", "\[CapitalDelta]temp",
       ",", "\[CapitalDelta]0"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"factors", " ", "=", " ", 
      RowBox[{"Lr", "@", "func"}]}], ";", "\n", 
     RowBox[{"mlist", " ", "=", " ", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"m", "[", "i", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "@", "factors"}]}], "}"}]}], " ", "]"}]}], ";", 
     "\n", 
     RowBox[{"A", " ", "=", " ", 
      RowBox[{"D", "[", " ", 
       RowBox[{"factors", ",", " ", 
        RowBox[{"{", "mlist", "}"}]}], " ", "]"}]}], ";", "\n", 
     RowBox[{"Cr", " ", "=", " ", 
      RowBox[{"D", "[", " ", 
       RowBox[{"factors", ",", " ", "k"}], " ", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]temp", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Inverse", "@", "A"}], ")"}], " ", ".", " ", "Cr"}]}]}], ";",
      " ", "\n", 
     RowBox[{"\[CapitalDelta]0", " ", "=", " ", 
      RowBox[{"Apply", "[", " ", 
       RowBox[{"Times", ",", " ", 
        RowBox[{"Denominator", "@", "\[CapitalDelta]temp"}]}], " ", "]"}]}], 
     ";", "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]temp", "*", "\[CapitalDelta]0"}], ",", " ", 
       "\[CapitalDelta]0"}], "}"}]}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.7643410652427015`*^9, 3.764341134682844*^9}, {
  3.764409608853686*^9, 3.764409644899886*^9}, {3.764578808696069*^9, 
  3.7645788154725447`*^9}, {3.76458463073808*^9, 3.76458463198796*^9}, {
  3.7649286858382363`*^9, 3.7649287081583853`*^9}, {3.7650130409249945`*^9, 
  3.7650130755695925`*^9}},ExpressionUUID->"e4a131e2-7a01-4a7c-8737-\
14491d122f24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "parFrac", "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "sure", " ", "about", " ", "the", " ", "Reverse"}], 
   " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"parFrac", "[", 
   RowBox[{"func_", ",", "indexList__"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sum", "[", " ", 
     RowBox[{
      RowBox[{"factor", "[", 
       RowBox[{"func", ",", " ", 
        RowBox[{"Reverse", "@", 
         RowBox[{
          RowBox[{"{", "indexList", "}"}], " ", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], " ", "]"}], ",", " ", 
      "##"}], "]"}], " ", "&"}], "@@", " ", 
   RowBox[{"{", "indexList", "}"}]}]}]}], "Code",
 CellChangeTimes->{{3.7645856900659285`*^9, 3.7645857317131925`*^9}, {
   3.764585763243147*^9, 3.76458578497307*^9}, {3.7645865053956203`*^9, 
   3.7645865359354706`*^9}, {3.7645866928626237`*^9, 
   3.7645866929622326`*^9}, {3.7645867297958307`*^9, 3.764586754522078*^9}, {
   3.7645867847035575`*^9, 3.764586841455309*^9}, {3.7645869517615013`*^9, 
   3.7645870056199102`*^9}, {3.764587041849395*^9, 3.7645871282505364`*^9}, {
   3.764587177820367*^9, 3.764587224693777*^9}, {3.764587276989979*^9, 
   3.764587317769761*^9}, {3.764587477089097*^9, 3.7645874783491135`*^9}, {
   3.764587950477045*^9, 3.7645880443167048`*^9}, {3.7645881039463167`*^9, 
   3.764588123229858*^9}, 3.764588605099742*^9, {3.7646818491784782`*^9, 
   3.7646818745882425`*^9}, {3.765012153829528*^9, 3.7650121541909347`*^9}, {
   3.765012924889643*^9, 3.7650129357716503`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"00eed4fd-7b5d-471f-9581-bc71fddde907"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "innerArg", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"innerArg", "[", "sumExpr_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nestedQ", ",", "innerSum", ",", "arg"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"nestedQ", " ", "=", " ", 
      RowBox[{"!", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"sumExpr", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "sum"}], "]"}]}]}], ";", 
     "\n", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nestedQ", " ", "\[Equal]", " ", "True"}], ",", "\n", "\t", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"innerSum", " ", "=", " ", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"sumExpr", ",", " ", 
            RowBox[{"sum", "[", 
             RowBox[{
              RowBox[{"_", "?", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"sum", "[", "__", "]"}]}], "]"}], "&"}], ")"}]}], 
              ",", " ", "_"}], "]"}], ",", " ", "All"}], "]"}], " ", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"arg", " ", "=", " ", 
         RowBox[{"innerSum", " ", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\n", "\t\t", "\n", "\t\t", 
       RowBox[{"sumExpr", " ", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "\n", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.7646818438104286`*^9, 3.764681862811855*^9}, {
  3.7649305761261487`*^9, 3.764930578483177*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"3a829629-d653-4931-821d-a91545b23293"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "break", "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Break", " ", "if", " ", "nested"}], " ", "\[Or]", " ", 
    RowBox[{"single", " ", "sum"}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"break", "[", "func_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "vars", "}"}], ",", " ", "\n", 
    RowBox[{
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"Variables", " ", "/@", " ", 
       RowBox[{"Lr", " ", "@", " ", "func"}]}]}], ";", " ", "\n", 
     RowBox[{
      RowBox[{"TrueQ", "[", " ", 
       RowBox[{
        RowBox[{"Length", "@", "vars"}], " ", "\[Equal]", " ", "1"}], " ", 
       "]"}], " ", "\[Or]", " ", 
      RowBox[{"TrueQ", " ", "[", " ", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"vars", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "#"}], " ", "\[Equal]", " ", "1"}], " ", 
          "&"}]}], "]"}], " ", "]"}]}]}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.764584480330412*^9, 3.7645845221483517`*^9}, {
  3.764584695810933*^9, 3.764584712887206*^9}, {3.7645847508762207`*^9, 
  3.764584815197044*^9}, {3.764584852036903*^9, 3.764584865376822*^9}, {
  3.7645849034701524`*^9, 3.7645849557161856`*^9}, {3.765001845847667*^9, 
  3.765001918110606*^9}, {3.765002109576643*^9, 3.7650021116805153`*^9}, {
  3.765002142356048*^9, 3.765002145239994*^9}, {3.765002219178844*^9, 
  3.7650022425270925`*^9}, {3.765013020182002*^9, 3.7650130227384453`*^9}, {
  3.765013100554783*^9, 
  3.7650131009538636`*^9}},ExpressionUUID->"9b42321a-05b2-4c34-a881-\
8c8b7aef022e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "varProd", "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Equation", " ", 
    RowBox[{"(", "14", ")"}], " ", "in", " ", "Anzai", " ", 
    RowBox[{"et", ".", " ", "al", "."}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"varProd", "[", 
   RowBox[{"sumExpr_", ",", "k_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "func", ",", "replaceList", ",", "\[CapitalDelta]", ",", "vars"}], "}"}],
     ",", "\n", 
    RowBox[{
     RowBox[{"func", " ", "=", " ", 
      RowBox[{"First", " ", "@", " ", "sumExpr"}]}], ";", " ", "\n", 
     RowBox[{"replaceList", " ", "=", " ", 
      RowBox[{
       RowBox[{"prodToList", " ", "@", " ", 
        RowBox[{"Numerator", " ", "@", " ", "func"}]}], "  ", "/.", " ", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{"x_", ",", 
          RowBox[{"m", "[", "i_", "]"}]}], "]"}], " ", "\[RuleDelayed]", " ", 
        RowBox[{"{", 
         RowBox[{"i", " ", "\[Rule]", " ", "x"}], "}"}]}]}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"delta", "[", 
        RowBox[{"func", ",", "k"}], "]"}], " ", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Variables", " ", "@", " ", "replaceList"}], " ", "\[Equal]",
          " ", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "\[CapitalDelta]"}]}], "]"}], ",", " ", "\n",
         "\t\t", 
        RowBox[{"ReplacePart", "[", " ", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", " ", 
            RowBox[{"Length", "@", "\[CapitalDelta]"}]}], "]"}], ",", " ", 
          RowBox[{"Flatten", " ", "@", " ", "replaceList"}]}], " ", "]"}]}], 
       "]"}]}], ";", "\n", "\n", 
     RowBox[{"Times", " ", "@@", " ", 
      RowBox[{"(", 
       RowBox[{"vars", " ", "^", " ", "\[CapitalDelta]"}], ")"}]}]}]}], 
   "]"}]}]}], "Code",
 CellChangeTimes->{
  3.764930604362555*^9, {3.764999060773371*^9, 3.764999080695619*^9}, {
   3.7649993632104893`*^9, 3.7649993946624827`*^9}, {3.764999776104114*^9, 
   3.764999780380686*^9}, {3.764999879710054*^9, 3.764999880550315*^9}, {
   3.765002803616144*^9, 3.7650028107223597`*^9}, {3.765004054129923*^9, 
   3.7650040606840067`*^9}, {3.76500415128963*^9, 3.7650042115128217`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e043d0fd-3464-482e-b21a-49a57058ce62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "deltaS", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"deltaS", "[", 
   RowBox[{"sumExpr_", ",", "k_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "shift", ",", "insertSummand", ",", "len", ",", "indexList", ",", "a", 
      ",", "b", ",", "\[CapitalDelta]", ",", "\[CapitalDelta]0", ",", 
      "\[Alpha]", ",", "\[Beta]", ",", "temp", ",", "tempSum", ",", "X"}], 
     "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"shift", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "n", "]"}], "]"}], " ", "/.", " ", 
            RowBox[{
             RowBox[{"indexList", "[", 
              RowBox[{"[", "n", "]"}], "]"}], " ", ":>", " ", 
             RowBox[{
              RowBox[{"indexList", "[", 
               RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "len"}], "}"}]}], "]"}], " ", "/.", 
         "  ", 
         RowBox[{"k", " ", ":>", " ", 
          RowBox[{"k", " ", "+", " ", "\[CapitalDelta]0"}]}]}], ")"}], " ", 
       "-", " ", "x"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"insertSummand", "[", "X_", "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sign", ",", "index"}], "}"}], ",", "\n", 
        RowBox[{
         RowBox[{"sign", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
              RowBox[{"-", "1"}]}], "]"}], ",", " ", 
            RowBox[{"-", "1"}], ",", " ", "1"}], "]"}]}], ";", "\n", 
         RowBox[{"index", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Delete", "[", 
             RowBox[{"#", ",", " ", "0"}], "]"}], " ", "&"}], "/@", " ", 
           RowBox[{"prodToList", "[", 
            RowBox[{"sign", "*", "X"}], "]"}]}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"varProd", "[", 
             RowBox[{"sumExpr", ",", "k"}], "]"}], " ", "*", " ", "sign", " ",
             "*", " ", 
            RowBox[{"sum", "[", 
             RowBox[{
              RowBox[{"First", "@", "sumExpr"}], ",", "##"}], "]"}]}], " ", 
           "&"}], "@@", " ", "index"}]}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"len", " ", "=", " ", 
      RowBox[{"Length", "@", 
       RowBox[{"indices", "[", "sumExpr", "]"}]}]}], ";", "\n", 
     RowBox[{"indexList", " ", "=", " ", 
      RowBox[{
       RowBox[{"indices", "[", "sumExpr", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"a", " ", "=", " ", 
      RowBox[{
       RowBox[{"indices", "[", "sumExpr", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{"b", " ", "=", " ", 
      RowBox[{
       RowBox[{"indices", "[", "sumExpr", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"\[CapitalDelta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"delta", "[", 
        RowBox[{
         RowBox[{"First", "@", "sumExpr"}], ",", "k"}], "]"}], " ", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]0", " ", "=", " ", 
      RowBox[{
       RowBox[{"delta", "[", 
        RowBox[{
         RowBox[{"First", "@", "sumExpr"}], ",", "k"}], "]"}], " ", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\n", "\n", 
     RowBox[{"\[Alpha]", " ", "=", " ", 
      RowBox[{"shift", "[", "a", "]"}]}], ";", "\n", 
     RowBox[{"\[Beta]", " ", "=", " ", 
      RowBox[{"shift", "[", "b", "]"}]}], ";", "\n", "\n", 
     RowBox[{"temp", " ", "=", " ", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "@", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"indexList", " ", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
              RowBox[{"a", " ", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
              RowBox[{"b", " ", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], " ", "}"}]}], " ", "-", " ", 
           RowBox[{"X", "@", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"indexList", " ", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
              RowBox[{"a", " ", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"a", " ", "[", 
                RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
               RowBox[{"\[Alpha]", " ", "[", 
                RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", "1"}]}], " ", 
             "}"}]}], " ", "+", " ", 
           RowBox[{"X", "@", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"indexList", " ", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"b", " ", "[", 
                RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", "1"}], ",", 
              " ", 
              RowBox[{
               RowBox[{"b", " ", "[", 
                RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
               RowBox[{"\[Beta]", " ", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}]}], " ", "}"}]}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "len"}], "}"}]}], "]"}], " ", "-", " ",
         "\n", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"X", "@", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"indexList", " ", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
             RowBox[{"a", " ", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", " ", 
             RowBox[{"b", " ", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], " ", "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "len"}], "}"}]}], "]"}]}], " ", "//", 
       " ", "Expand"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"insertSummand", ",", "temp"}], "]"}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"sum", "[", 
        RowBox[{"x_", ",", "y__"}], "]"}], " ", "\[RuleDelayed]", " ", 
       RowBox[{"parFrac", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.7643407948689833`*^9, 3.7643408140950813`*^9}, {
   3.7643409289606752`*^9, 3.7643409417080097`*^9}, {3.7643414043294106`*^9, 
   3.764341405051001*^9}, {3.7643414594157715`*^9, 3.7643414617144375`*^9}, 
   3.764341589200964*^9, {3.764341741904317*^9, 3.7643418448868494`*^9}, {
   3.7644026132157216`*^9, 3.7644026500860863`*^9}, {3.7644028915947866`*^9, 
   3.7644029544342747`*^9}, {3.764402990414516*^9, 3.7644030785339766`*^9}, 
   3.7644033044528236`*^9, {3.764403343676939*^9, 3.7644033954124455`*^9}, {
   3.7644034480824647`*^9, 3.764403452406111*^9}, {3.764403505292214*^9, 
   3.764403571205167*^9}, {3.7644037646197453`*^9, 3.764403839604227*^9}, {
   3.764403877110255*^9, 3.7644038939334855`*^9}, 3.7644039415734863`*^9, {
   3.7644040497885427`*^9, 3.7644040523777075`*^9}, {3.7644057925784674`*^9, 
   3.764405835464704*^9}, {3.7644058934534674`*^9, 3.764405946944135*^9}, {
   3.7644060324639454`*^9, 3.7644060597939167`*^9}, {3.764406175096756*^9, 
   3.7644062258732123`*^9}, 3.7644067263132887`*^9, {3.7644067890499835`*^9, 
   3.764406820493493*^9}, {3.7644069119602723`*^9, 3.764406920440199*^9}, {
   3.764407219168934*^9, 3.7644072387822695`*^9}, {3.764407558847072*^9, 
   3.7644076003270264`*^9}, {3.764407636627306*^9, 3.7644076827967777`*^9}, {
   3.7644077700911093`*^9, 3.764407778299859*^9}, {3.76440867075558*^9, 
   3.764408676165633*^9}, {3.764578379964636*^9, 3.764578394934899*^9}, {
   3.764578425884713*^9, 3.7645784329071836`*^9}, 3.764578503993945*^9, {
   3.764582628802883*^9, 3.76458263412488*^9}, {3.7645827700514364`*^9, 
   3.7645828631440763`*^9}, {3.7645828984440346`*^9, 3.7645829001795683`*^9}, 
   3.764582973360666*^9, {3.7645830827798104`*^9, 3.7645831772997713`*^9}, {
   3.764584120210018*^9, 3.7645841395831757`*^9}, {3.764586561918871*^9, 
   3.764586562143676*^9}, {3.7645878743174796`*^9, 3.764587892266123*^9}, {
   3.7645879244872727`*^9, 3.76458793623599*^9}, {3.764588051836415*^9, 
   3.7645880862163615`*^9}, 3.764588135756014*^9, {3.764588739111816*^9, 
   3.764588765496866*^9}, {3.764589700215876*^9, 3.764589741913696*^9}, {
   3.76492694244726*^9, 3.764926942604188*^9}, {3.7649269778750415`*^9, 
   3.764926991639626*^9}, {3.764927879213753*^9, 3.7649278910595045`*^9}, {
   3.7649286377683477`*^9, 3.764928644638629*^9}, {3.764928728557997*^9, 
   3.764928732770624*^9}, {3.764929165476453*^9, 3.7649291668063*^9}, {
   3.764930576157403*^9, 3.7649305785209646`*^9}, {3.764930753166379*^9, 
   3.764930785172595*^9}, 3.765003084941697*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"863ec8f9-651e-4f78-8b18-b9613e47c1c0"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["\[CapitalDelta]S (don\[CloseCurlyQuote]t forget \
single sums)",
 FontSize->18]], "Section",
 CellChangeTimes->{{3.763896067498708*^9, 
  3.763896092117256*^9}},ExpressionUUID->"de617130-2ebd-432f-98c6-\
471b2a66d39c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"testsum1", ",", "testsum2"}], "]"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"testsum1", " ", "=", " ", 
   RowBox[{"sum", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], 
       RowBox[{"m", "[", "1", "]"}]], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Delta]", "+", 
       RowBox[{"m", "[", "1", "]"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "1", "]"}], ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"testsum2", " ", "=", "   ", 
   RowBox[{"sum", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], 
       RowBox[{"m", "[", "2", "]"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], "-", 
         RowBox[{"m", "[", "2", "]"}], " ", "+", "\[Delta]1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"m", "[", "2", "]"}], " ", "+", " ", "\[Delta]2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], "-", 
         RowBox[{"m", "[", "3", "]"}], " ", "+", " ", "\[Delta]3"}], ")"}]}]],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "1", "]"}], ",", "1", ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "2", "]"}], ",", 
       RowBox[{"1", "+", 
        RowBox[{"m", "[", "1", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "3", "]"}], ",", 
       RowBox[{"1", "+", 
        RowBox[{"m", "[", "2", "]"}]}], ",", "k"}], "}"}]}], "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{
  3.763896079518587*^9, {3.764340665341704*^9, 3.7643407268274364`*^9}, {
   3.764341031225566*^9, 3.764341033338348*^9}, {3.7643411985913706`*^9, 
   3.7643412063242397`*^9}, {3.764341373361287*^9, 3.7643413806700497`*^9}, {
   3.7644036265717087`*^9, 3.76440365246144*^9}, {3.764409759964665*^9, 
   3.7644097733008575`*^9}, 3.764409806381898*^9, {3.764578279504994*^9, 
   3.7645782831649885`*^9}, {3.7645783244049063`*^9, 3.764578332604684*^9}, {
   3.764578791153037*^9, 3.7645787929728546`*^9}, 3.764588613942298*^9, {
   3.764930221060192*^9, 3.7649302219945555`*^9}, {3.764930387849568*^9, 
   3.7649304323898497`*^9}, 3.764930808006398*^9, {3.7649972246287675`*^9, 
   3.764997230188748*^9}, 3.7649998886102905`*^9, {3.7650032249906697`*^9, 
   3.7650032478707523`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"0251ef35-efb8-47d3-b56d-0256874c172c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"deltaS", "[", 
  RowBox[{"testsum1", ",", "k"}], "]"}], "\n", 
 RowBox[{"deltaS", "[", 
  RowBox[{"testsum2", ",", "k"}], "]"}]}], "Code",
 CellChangeTimes->{{3.7643409915552416`*^9, 3.764340997822624*^9}, {
  3.764341040187377*^9, 3.7643410404522266`*^9}, {3.7643411425537615`*^9, 
  3.764341175922599*^9}, {3.764341209888839*^9, 3.7643412120428677`*^9}, {
  3.764341341318593*^9, 3.7643414205610647`*^9}, {3.7643414852085385`*^9, 
  3.764341496529013*^9}, {3.764341885093665*^9, 3.764341906717198*^9}, {
  3.764578797493436*^9, 3.764578797802755*^9}, {3.7649269941851454`*^9, 
  3.7649270005524635`*^9}, {3.764927881823741*^9, 3.764927886412037*^9}, {
  3.7649284919789705`*^9, 3.764928507599286*^9}, {3.7649286482723017`*^9, 
  3.764928669078115*^9}, {3.7649287443121004`*^9, 3.76492874756819*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"dc96eb7e-8fd8-4244-9a4a-599685021756"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", "x"], ")"}], 
   RowBox[{"1", "+", "k"}]], 
  RowBox[{"k", "+", "\[Delta]"}]]], "Output",
 CellChangeTimes->{
  3.764341003740211*^9, {3.7643410345806084`*^9, 3.764341040889974*^9}, {
   3.764341154254012*^9, 3.764341176281393*^9}, {3.7643412076740217`*^9, 
   3.7643412123637843`*^9}, {3.7643413487054796`*^9, 3.764341421083762*^9}, {
   3.7643414684775405`*^9, 3.764341496937776*^9}, 3.7643415928168917`*^9, {
   3.764341750635727*^9, 3.764341815627326*^9}, 3.7643418541944895`*^9, {
   3.764341885477457*^9, 3.764341907084985*^9}, 3.7643419675474834`*^9, 
   3.764402538986164*^9, 3.7644026511995735`*^9, 3.764403050147343*^9, 
   3.7644030803840127`*^9, 3.764403396832203*^9, 3.764403454102191*^9, 
   3.764403507102002*^9, 3.764403573315241*^9, 3.764403655551366*^9, 
   3.7644038466040497`*^9, 3.7644039082402425`*^9, 3.764404055328573*^9, {
   3.764405913797884*^9, 3.7644059489540763`*^9}, {3.764406039393879*^9, 
   3.764406061943903*^9}, 3.764406728601012*^9, 3.764406807316989*^9, 
   3.7644069236040554`*^9, {3.7644072288686857`*^9, 3.764407241138708*^9}, {
   3.7644076620290117`*^9, 3.7644076838403473`*^9}, {3.7644077736266947`*^9, 
   3.764407780598365*^9}, 3.764408677524548*^9, 3.7644087348093724`*^9, 
   3.764408996714178*^9, {3.764409455825887*^9, 3.7644094956860433`*^9}, 
   3.764409809879322*^9, 3.764410658423278*^9, {3.7645782862350826`*^9, 
   3.7645782900450706`*^9}, 3.76457833657474*^9, 3.7645784364240837`*^9, 
   3.764578506814164*^9, {3.7645787987427716`*^9, 3.764578819412615*^9}, {
   3.7645828213650064`*^9, 3.764582864324645*^9}, 3.764582901350938*^9, {
   3.764582975330144*^9, 3.7645829927036047`*^9}, 3.7645831813580923`*^9, {
   3.764584121409853*^9, 3.7645841454998803`*^9}, 3.764584652609606*^9, 
   3.7645856025240073`*^9, 3.764586564375332*^9, 3.764587894650809*^9, 
   3.764587925907234*^9, 3.7645880875962996`*^9, {3.7645881267799387`*^9, 
   3.764588137956403*^9}, {3.764588743998767*^9, 3.764588767032341*^9}, {
   3.7645897065524426`*^9, 3.764589742985655*^9}, 3.7646595970660653`*^9, 
   3.7646810429598475`*^9, 3.7649265900050507`*^9, 3.764926944560944*^9, {
   3.7649270013390255`*^9, 3.7649270048208933`*^9}, 3.764927894281807*^9, 
   3.7649285160633*^9, {3.764928652202174*^9, 3.76492866935828*^9}, {
   3.7649287421678*^9, 3.764928747827779*^9}, 3.7649291695661135`*^9, {
   3.764930764730872*^9, 3.764930811823055*^9}, 3.764931668280854*^9, 
   3.7649321412440352`*^9, 3.764942089936078*^9, 3.7649954299552836`*^9, 
   3.765004217752134*^9, 3.7650049875001054`*^9, 3.765009642109295*^9, 
   3.765012299263918*^9, 3.7650127918973894`*^9, 3.765012941152144*^9, 
   3.7650131237074385`*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"b3800e43-3470-498a-9aaa-5af44d2bb4ee"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "x"], ")"}], "k"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Delta]1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "k", "+", "\[Delta]2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Delta]3"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "x"], ")"}], "k"], " ", 
    RowBox[{"sum", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "k"}], "+", "\[Delta]1", "+", 
        RowBox[{"m", "[", "1", "]"}]}]], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], ",", "1", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "k"}]}], "}"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "k", "+", "\[Delta]2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Delta]3"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"sum", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], 
       RowBox[{"m", "[", "2", "]"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Delta]2", "+", 
         RowBox[{"m", "[", "2", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Delta]1"}], "-", 
         RowBox[{"m", "[", "1", "]"}], "+", 
         RowBox[{"m", "[", "2", "]"}]}], ")"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "1", "]"}], ",", "1", ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "2", "]"}], ",", 
       RowBox[{"1", "+", 
        RowBox[{"m", "[", "1", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "k"}]}], "}"}]}], "]"}], 
   RowBox[{"k", "+", "\[Delta]2", "-", "\[Delta]3"}]], "-", 
  FractionBox[
   RowBox[{"sum", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], 
       RowBox[{"m", "[", "2", "]"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "k", "+", "\[Delta]3", "+", 
         RowBox[{"m", "[", "2", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Delta]1"}], "-", 
         RowBox[{"m", "[", "1", "]"}], "+", 
         RowBox[{"m", "[", "2", "]"}]}], ")"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "1", "]"}], ",", "1", ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "2", "]"}], ",", 
       RowBox[{"1", "+", 
        RowBox[{"m", "[", "1", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "k"}]}], "}"}]}], "]"}], 
   RowBox[{"k", "+", "\[Delta]2", "-", "\[Delta]3"}]]}]], "Output",
 CellChangeTimes->{
  3.764341003740211*^9, {3.7643410345806084`*^9, 3.764341040889974*^9}, {
   3.764341154254012*^9, 3.764341176281393*^9}, {3.7643412076740217`*^9, 
   3.7643412123637843`*^9}, {3.7643413487054796`*^9, 3.764341421083762*^9}, {
   3.7643414684775405`*^9, 3.764341496937776*^9}, 3.7643415928168917`*^9, {
   3.764341750635727*^9, 3.764341815627326*^9}, 3.7643418541944895`*^9, {
   3.764341885477457*^9, 3.764341907084985*^9}, 3.7643419675474834`*^9, 
   3.764402538986164*^9, 3.7644026511995735`*^9, 3.764403050147343*^9, 
   3.7644030803840127`*^9, 3.764403396832203*^9, 3.764403454102191*^9, 
   3.764403507102002*^9, 3.764403573315241*^9, 3.764403655551366*^9, 
   3.7644038466040497`*^9, 3.7644039082402425`*^9, 3.764404055328573*^9, {
   3.764405913797884*^9, 3.7644059489540763`*^9}, {3.764406039393879*^9, 
   3.764406061943903*^9}, 3.764406728601012*^9, 3.764406807316989*^9, 
   3.7644069236040554`*^9, {3.7644072288686857`*^9, 3.764407241138708*^9}, {
   3.7644076620290117`*^9, 3.7644076838403473`*^9}, {3.7644077736266947`*^9, 
   3.764407780598365*^9}, 3.764408677524548*^9, 3.7644087348093724`*^9, 
   3.764408996714178*^9, {3.764409455825887*^9, 3.7644094956860433`*^9}, 
   3.764409809879322*^9, 3.764410658423278*^9, {3.7645782862350826`*^9, 
   3.7645782900450706`*^9}, 3.76457833657474*^9, 3.7645784364240837`*^9, 
   3.764578506814164*^9, {3.7645787987427716`*^9, 3.764578819412615*^9}, {
   3.7645828213650064`*^9, 3.764582864324645*^9}, 3.764582901350938*^9, {
   3.764582975330144*^9, 3.7645829927036047`*^9}, 3.7645831813580923`*^9, {
   3.764584121409853*^9, 3.7645841454998803`*^9}, 3.764584652609606*^9, 
   3.7645856025240073`*^9, 3.764586564375332*^9, 3.764587894650809*^9, 
   3.764587925907234*^9, 3.7645880875962996`*^9, {3.7645881267799387`*^9, 
   3.764588137956403*^9}, {3.764588743998767*^9, 3.764588767032341*^9}, {
   3.7645897065524426`*^9, 3.764589742985655*^9}, 3.7646595970660653`*^9, 
   3.7646810429598475`*^9, 3.7649265900050507`*^9, 3.764926944560944*^9, {
   3.7649270013390255`*^9, 3.7649270048208933`*^9}, 3.764927894281807*^9, 
   3.7649285160633*^9, {3.764928652202174*^9, 3.76492866935828*^9}, {
   3.7649287421678*^9, 3.764928747827779*^9}, 3.7649291695661135`*^9, {
   3.764930764730872*^9, 3.764930811823055*^9}, 3.764931668280854*^9, 
   3.7649321412440352`*^9, 3.764942089936078*^9, 3.7649954299552836`*^9, 
   3.765004217752134*^9, 3.7650049875001054`*^9, 3.765009642109295*^9, 
   3.765012299263918*^9, 3.7650127918973894`*^9, 3.765012941152144*^9, 
   3.765013123760063*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"163e8a26-061e-4788-98ac-71742e84dd63"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nest", "Section",
 CellChangeTimes->{{3.764587327589807*^9, 
  3.7645873280102987`*^9}},ExpressionUUID->"6d87726f-4d08-4494-84fa-\
485a9fcd1d37"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["S", "2"], "[", 
   RowBox[{"sumExpr_", ",", "k_", ",", 
    RowBox[{"n", "[", "i_", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CapitalDelta]0", ",", "\[CapitalDelta]S", ",", "\[Lambda]"}], 
     "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{"\[CapitalDelta]0", " ", "=", " ", "1"}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Only", " ", "\[NotEqual]", " ", 
        RowBox[{"1", " ", "for", " ", "factors", " ", "with", " ", "terms"}], 
        " ", "\[Tilde]", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"q", " ", "*", " ", "k"}], " ", "|", " ", 
           RowBox[{"n", " ", "\[Element]", " ", 
            TemplateBox[{},
             "Rationals"]}]}], "}"}], ".", " ", "Also"}]}], ",", " ", 
       RowBox[{"\[Nu]0", " ", "=", " ", "0."}]}], " ", "*)"}], ";", "\n", 
     "\n", 
     RowBox[{"\[CapitalDelta]S", " ", "=", " ", 
      RowBox[{"deltaS", "[", 
       RowBox[{"sumExpr", ",", "k"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"\[Lambda]", " ", "=", " ", 
      RowBox[{"varProd", "[", 
       RowBox[{"sumExpr", ",", "k"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{"\[Lambda]", ",", " ", 
           FractionBox["k", "\[CapitalDelta]0"]}], "]"}], " ", "*", " ", 
         "sumExpr"}], " ", "/.", " ", 
        RowBox[{"k", " ", "\[Rule]", " ", "0"}]}], ")"}], " ", "+", " ", 
      RowBox[{"sum", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"\[CapitalDelta]S", " ", "/.", " ", 
           RowBox[{"k", " ", "\[Rule]", " ", 
            RowBox[{"n", "[", "i", "]"}]}]}], " ", ")"}], " ", "*", " ", 
         RowBox[{"Power", "[", 
          RowBox[{"\[Lambda]", ",", " ", 
           FractionBox[
            RowBox[{"k", " ", "-", " ", 
             RowBox[{"n", "[", "i", "]"}], " ", "-", " ", 
             "\[CapitalDelta]0"}], "\[CapitalDelta]0"]}], " ", "]"}]}], " ", 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "[", "i", "]"}], ",", " ", "0", ",", " ", 
          RowBox[{"k", "-", "1"}]}], "}"}]}], " ", "]"}]}]}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.7649958126836643`*^9, 3.7649958135871754`*^9}, {
   3.764998290074221*^9, 3.7649983353370776`*^9}, {3.76500245607625*^9, 
   3.7650025579662185`*^9}, {3.7650026831751065`*^9, 3.765002687245515*^9}, {
   3.765002815252555*^9, 3.7650029318903613`*^9}, {3.7650029632521734`*^9, 
   3.765003030341919*^9}, 3.7650031540410213`*^9, {3.7650096173758593`*^9, 
   3.765009625129679*^9}, {3.765009690894103*^9, 3.765009702916767*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"84d49ea9-1b9c-400c-adfb-002c4132c524"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["S", "2"], "[", " ", 
    RowBox[{"testsum2", ",", " ", "k", ",", " ", 
     RowBox[{"n", "[", "1", "]"}]}], " ", "]"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]1", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Delta]2", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Delta]3", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Delta]", " ", "\[Rule]", " ", "0"}]}], "}"}]}], " ", "/.", 
  " ", "sumReduce"}]], "Code",
 CellChangeTimes->{{3.7649296923370104`*^9, 3.7649297413227043`*^9}, {
   3.7649302378803253`*^9, 3.764930278310438*^9}, 3.7649303293998666`*^9, {
   3.764931324339785*^9, 3.7649313489894404`*^9}, {3.7649314208670077`*^9, 
   3.764931426866273*^9}, {3.764931680868135*^9, 3.764931685034619*^9}, {
   3.764942064943974*^9, 3.764942066501963*^9}, 3.764995843811816*^9, {
   3.7649967249709206`*^9, 3.7649967765172043`*^9}, {3.764996807995903*^9, 
   3.764996818364269*^9}, {3.76499731620018*^9, 3.7649973247966805`*^9}, {
   3.7649981765845366`*^9, 3.764998178514761*^9}, {3.7649982624639254`*^9, 
   3.7649982627179227`*^9}, {3.76499829895415*^9, 3.764998300643879*^9}, {
   3.764998398183591*^9, 3.7649984207068596`*^9}, 3.764998485033231*^9, {
   3.764998979284153*^9, 3.7649989797540445`*^9}, {3.7649990969317236`*^9, 
   3.764999100971595*^9}, {3.7649994051464753`*^9, 3.7649994111341534`*^9}, {
   3.7649998689191213`*^9, 3.7649998730217824`*^9}, {3.765002568845621*^9, 
   3.7650025703941097`*^9}, {3.7650026043352747`*^9, 
   3.7650026047288923`*^9}, {3.765003194490769*^9, 3.7650032118807707`*^9}, {
   3.7650033119893026`*^9, 3.7650033806929393`*^9}, {3.76500341881851*^9, 
   3.7650034249227905`*^9}, {3.7650096668503532`*^9, 
   3.7650097047762485`*^9}, {3.7650128870131626`*^9, 3.76501291211587*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"6ee41efc-4ada-441e-93d5-f5a707a3f6c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sum", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"sum", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], 
         RowBox[{"m", "[", "2", "]"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"m", "[", "2", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"m", "[", "1", "]"}]}], "+", 
           RowBox[{"m", "[", "2", "]"}]}], ")"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"n", "[", "1", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"m", "[", "1", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"n", "[", "1", "]"}]}]}], "}"}]}], "]"}], 
     RowBox[{"n", "[", "1", "]"}]], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]}], "}"}]}], "]"}], "-", 
  RowBox[{"sum", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"sum", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], 
         RowBox[{"m", "[", "2", "]"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"m", "[", "1", "]"}]}], "+", 
           RowBox[{"m", "[", "2", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"m", "[", "2", "]"}], "-", 
           RowBox[{"n", "[", "1", "]"}]}], ")"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"n", "[", "1", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"m", "[", "1", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"n", "[", "1", "]"}]}]}], "}"}]}], "]"}], 
     RowBox[{"n", "[", "1", "]"}]], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]}], "}"}]}], "]"}], "+", 
  RowBox[{"sum", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], 
       RowBox[{"n", "[", "1", "]"}]], " ", 
      RowBox[{"Z", "[", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"n", "[", "1", "]"}]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"n", "[", "1", "]"}]}]], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]}], "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.764998421367587*^9, 3.764998485423546*^9, 3.764998981318165*^9, 
   3.7649991013133245`*^9, {3.7649994018023386`*^9, 3.76499943985219*^9}, {
   3.764999869330196*^9, 3.7649998733904204`*^9}, {3.7650025795658207`*^9, 
   3.765002605659677*^9}, {3.7650030337018185`*^9, 3.7650030581413507`*^9}, 
   3.7650030894514065`*^9, {3.7650031964210477`*^9, 3.7650032371843624`*^9}, {
   3.76500331546358*^9, 3.7650033814491715`*^9}, {3.765003419288477*^9, 
   3.7650034253386555`*^9}, 3.765004231288968*^9, 3.7650049877821264`*^9, 
   3.765009642231681*^9, {3.7650096731545353`*^9, 3.765009705293313*^9}, 
   3.7650128307696333`*^9, {3.76501289333906*^9, 3.7650129127958064`*^9}, 
   3.765012951340682*^9, 3.765013128309749*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"b880ab77-0bd3-4f4c-80bd-1d3506564519"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 656, 14, 75, "Code",ExpressionUUID->"a81b38c6-db3a-4a9f-a08f-cd828d9f6c3f"],
Cell[1239, 38, 398, 9, 43, "Print",ExpressionUUID->"3547c7cb-b769-43a9-a210-5cdea7301305"],
Cell[1640, 49, 155, 2, 36, "Output",ExpressionUUID->"24fe46e8-e279-4bbd-a525-a7ed7b55a2b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1832, 56, 193, 4, 59, "Section",ExpressionUUID->"ab6eaadb-ac90-4cc4-9736-f9aef3928c7e"],
Cell[2028, 62, 2516, 61, 266, "Code",ExpressionUUID->"e4a131e2-7a01-4a7c-8737-14491d122f24"],
Cell[4547, 125, 1686, 35, 132, "Code",ExpressionUUID->"00eed4fd-7b5d-471f-9581-bc71fddde907"],
Cell[6236, 162, 1757, 45, 265, "Code",ExpressionUUID->"3a829629-d653-4931-821d-a91545b23293"],
Cell[7996, 209, 1646, 37, 189, "Code",ExpressionUUID->"9b42321a-05b2-4c34-a881-8c8b7aef022e"],
Cell[9645, 248, 2621, 62, 265, "Code",ExpressionUUID->"e043d0fd-3464-482e-b21a-49a57058ce62"],
Cell[12269, 312, 9492, 208, 607, "Code",ExpressionUUID->"863ec8f9-651e-4f78-8b18-b9613e47c1c0"]
}, Closed]],
Cell[CellGroupData[{
Cell[21798, 525, 242, 5, 43, "Section",ExpressionUUID->"de617130-2ebd-432f-98c6-471b2a66d39c"],
Cell[22043, 532, 2775, 75, 207, "Code",ExpressionUUID->"0251ef35-efb8-47d3-b56d-0256874c172c"],
Cell[CellGroupData[{
Cell[24843, 611, 909, 15, 75, "Code",ExpressionUUID->"dc96eb7e-8fd8-4244-9a4a-599685021756"],
Cell[25755, 628, 2811, 44, 64, "Output",ExpressionUUID->"b3800e43-3470-498a-9aaa-5af44d2bb4ee"],
Cell[28569, 674, 5690, 138, 139, "Output",ExpressionUUID->"163e8a26-061e-4788-98ac-71742e84dd63"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34308, 818, 151, 3, 73, "Section",ExpressionUUID->"6d87726f-4d08-4494-84fa-485a9fcd1d37"],
Cell[34462, 823, 2863, 68, 276, "Code",ExpressionUUID->"84d49ea9-1b9c-400c-adfb-002c4132c524"],
Cell[CellGroupData[{
Cell[37350, 895, 1928, 33, 55, "Code",ExpressionUUID->"6ee41efc-4ada-441e-93d5-f5a707a3f6c8"],
Cell[39281, 930, 4007, 116, 151, "Output",ExpressionUUID->"b880ab77-0bd3-4f4c-80bd-1d3506564519"]
}, Open  ]]
}, Open  ]]
}
]
*)

